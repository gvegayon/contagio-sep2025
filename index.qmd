---
title: Transmisión y Contagio en Redes
subtitle: Una introducción breve
author: 
  - name: George G. Vega Yon, Ph.D.
    affiliation: The University of Utah
    email: george.vegayon@utah.edu
date: 2025-09-03
bibliography: references.bib
format:
    revealjs:
        embed-resources: true
        slide-number: c/t
        scrollable: true
        footer: George G. Vega Yon, Ph.D. | The University of Utah | <george.vegayon@utah.edu>
        incremental: true
fontsize: 200%
nocite: |
    @valente_yon_2020
---

# Mirada general {background-color="#be0000"}

## Distintos Objetivos

Durante esta presentacion, discutiremos los siguientes tipos de modelos:

- **Inferencia**: Modelos mecanisticos desarrollados para realizar inferencia estadistica en algun parametro poblacional, por ejemplo, la tasa de adopcion de una innovacion o la infectividad de un patogeno.

- **Predicción**: Modelos no necesariamente mecanisticos que buscan predecir el comportamiento futuro de la red o de sus actores, por ejemplo, el numero de adopciones en el futuro o la propagación de una enfermedad.

- **Escenarios**: Modelos que ayudan a explorar de manera relativa los efectos de distintas intervenciones/cambios generados en el sistema. Algunos ejemplos incluyen comparar estrategias para combatir un brote de una enfermedad o identificar lideres en un grupo para maximizar la difusión de una innovación.

## Paquetes estadísticos 

Existen varios paquetes disponibles para el análisis de difusión en redes:

::: {style="font-size: 80%"}

| Paquete | Enfoque | Recomendacion |
|---------|---------|---------------|
| [**netdiffuseR**](https://cran.r-project.org/package=netdiffuseR) | Inferencia y Escenarios | Modelos de difusion basados en exposicion. Utiliza modelos de regresion rezagada para analizar la propagacion de innovaciones. |
| [**RSiena**](https://cran.r-project.org/package=RSiena) | Inferencia | Estado el arte para estudiar la co-evolucion de red y comportamiento a traves de los modelos SOAM. |
| [**EpiModel**](https://cran.r-project.org/package=EpiModel) | Escenarios | Ideado para simular la propagacion de enfermedades infecciosas. Utiliza el paquete ERGM para simular cambios en la red. |
| [**epiworldR**](https://cran.r-project.org/package=epiworldR) | Escenarios | Similar a EpiModel, pero con un enfoque en poblaciones de mayor tamano y la simulacion de intervenciones de manera dinamica. |

:::

Puedes aprender más en el [*CRAN Task View* de **Network Analysis**](	https://CRAN.R-project.org/view=NetworkAnalysis){target="_blank"} y en el libro ["Ciencia de Redes Aplicada con R"](https://book.ggvy.cl/es/){target="_blank"}.

# Modelos de Difusión {background-color="#be0000"}

## Modelos de Difusión

- Los modelos de difusión en redes describen cómo las ideas o comportamientos se propagan a través de una red social.

* Uno de los conceptos canónicos es el umbral de red. Los umbrales de red [@valenteNetworkModelsDiffusion1995; @valenteSocialNetworkThresholds1996b], $\tau$, se definen como la proporción requerida o número de vecinos que te llevan a adoptar un comportamiento particular (innovación), $a=1$.

> Para el individuo $i$, adoptará el comportamiento/innovación $xyz$ si y solo si un $\tau$ por ciento de sus pares lo han adoptado. En otras palabras, para que $i$ adopte, al menos un $\tau$ por ciento de sus vecinos deben haber adoptado $xyz$.

## {style="font-size: 90%"}

![Diagrama por Dr. Valente](fig/slides-indirect-expo.png){width="50%"}

En términos (muy) generales
    
$$
a_i = \left\{\begin{array}{ll}
1 & \text{si } \tau_i \leq E_i \\
0 & \text{en otro caso}
\end{array}\right. \quad
E_i \equiv \frac{\sum_{j\neq i}\mathbf{X}_{ij}a_j}{\sum_{j\neq i}\mathbf{X}_{ij}}
$$
    
Donde $E_i$ es la exposición de $i$ a la innovación y $\mathbf{X}$ es la matriz de adyacencia (la red).

Esto puede generalizarse y extenderse para incluir covariables y otros esquemas de ponderación de red.


## Umbrales (Exposición) (Cont.) {style="font-size: 90%"}

Existen varios tipos de exposición que pueden ser considerados:

- **Exposición cohesiva**: Proporción o número de pares que adoptan la innovación (cohesión).
- **Exposición homofílica**: Proporción de pares que adoptan la innovación y son similares en características (homofilia). Por ejemplo, proporción de amigos de mi mismo sexo que adoptaron la innovación.
- **Exposición estructural**: Proporción de individuos que adoptaron y que tienen una posición similar a la mía en la red. Por ejemplo, en el caso de un presidente de partido, proporción de presidentes de partido que adoptaron la innovación.
- **Exposición basada en centralidad**: Basada en pares; aquellos individuos con mayor grado de centralidad ejercen un mayor impacto en la difusión de la innovación.

Para otros ejemplos, pueden revisar el contenido del tutorial de [**netdiffuseR** acá](https://usccana.github.io/netdiffuser-workshop/1-theory.html).

---

- El modelo de Valente es completamente determinístico.
- Esto significa que la adopción está dada completamente por la estructura de la red y los umbrales individuales.

```{mermaid}
flowchart LR
    A[Individuo i] -->|Vecino j adopta| B{"Exposición E(i)"}
    B -->|"`E(i) >= tau(i)`"| C["Adopta a(i)=1"]
    B -->|"`E(i) < tau(i)`"| D["No adopta a(i)=0"]
```

- Sin embargo, el umbral puede ser en sí mismo una función de otras variables, como por ejemplo, la edad del individuo.

## Tipos de preguntas que se pueden hacer

Fundamentalmente dos tipos:

1. **Simulación de escenarios**. En una intervención donde se busca reducir el uso del tabaco, ¿quiénes serían las *personas óptimas* para dirigir la campaña de concientización? (key players)
2. **Inferencia**. ¿Qué tipo de exposición fue más importante para la adopción de un comportamiento o innovación?

Varios ejemplos más en la literatura incluyen: Innovaciones médicas [@Coleman1966; @sargentAssessingDynamicsPrEP2024a]; Métodos anticonceptivos [@rogers_book_1981]; Innovaciones en métodos de cultivo [@rogers1970diffusion]; Uso del cigarrillo en adolescentes [@hayeSmokingDiffusionNetworks2019]; y políticas de control de tabaco [@valenteNetworkInfluencesPolicy2019]. 

# Modelos de Transmisión {background-color="#be0000"}

## Modelos de Simulación Basados en Agentes en Epidemiología

- Los modelos de transmisión en epidemiología tienen varios objetivos:
  a. **Inferencia** estadística de parámetros epidemiológicos.
  b. **Predicción** de la propagación de enfermedades.
  c. **Evaluación** de intervenciones de salud pública.
- Uno de los tipos de modelos más importantes en el área corresponde a los modelos de simulación basados en agentes (ABM por sus siglas en inglés).
- En los ABM, los individuos son representados como agentes que interactúan entre sí y con su entorno. La interacción puede ser de varias maneras distintas y altamente complejas.

## Modelos ABM básicos: SEIR

- El modelo SEIR (Susceptible–Expuesto–Infectado–Recuperado) es uno de los modelos fundamentales en el área ([wiki](https://es.wikipedia.org/w/index.php?title=Modelos_compartimentales_en_epidemiolog%C3%ADa&oldid=166823427#Modelo_SEIR){target="_blank"}).

```{mermaid}
flowchart LR
    S[Susceptible] -->E[Expuesto]
    E -->I[Infectado]
    I -->R[Recuperado]
```

- Desde el punto de vista de la interacción, la transición más importante es de Susceptible a Expuesto.

- A diferencia del modelo de difusion, en el modelo SEIR la transmision es probabilistica (no deterministica).

- En relacion a modelos de contagio de comportamiento, el contagio de enfermedades suele llamarse contagio "simple".

## Velocidad de propagación

::: {.columns}

::: {.column width="50%"}

- Número de Reproducción Básico (R0): Número promedio de casos secundarios en una **población completamente susceptible**.
- Número de Reproducción Efectivo (R): Número promedio de casos secundarios en una **población que no es completamente susceptible**.
- R* > 1 indica que la enfermedad se propaga en la población.
- Inmunidad colectiva (de rebaño): $1 - 1/R_0$ (en el caso del sarampión, 1 - 1/15 ~ 0.933)

:::

::: {.column width="50%"}
![Número de Reproducción Básico (R0) para varias enfermedades](fig/herd_immunity.png){width="100%"}
:::

:::

## Ejemplo de ABM

Las siguientes imágenes ilustran dos resultados importantes de un modelo SEIR: las curvas de incidencia y el numero de reproduccion efectivo.

::: {.columns}

::: {.column width="50%"}
![Curvas de incidencia de un modelo SEIR. Datos simulados utilizando el paquete epiworldR.](fig/seir-conn.png){width="100%"}
:::

::: {.column width="50%"}
![Numero de reproduccion efectivo (Rt) de un modelo SEIR. Datos simulados utilizando el paquete epiworldR.](fig/rt.png){width="100%"}
:::

:::

## Tipos de preguntas que se pueden hacer

- A pesar de que los ABM dan espacio para prediccion de parametros e inferencia estadistica, debido a que corresponden a modelos simplificados de la realidad, son mas adecuados para la evaluacion de intervenciones. Por ejemplo

> En el caso de un brote de sarampión, ¿que es mas efectivo? (vacunación masiva vs. cuarentena). Desde el punto de vista economico, que estrategia es la mas eficiente? (los famosos [QALYs](https://es.wikipedia.org/w/index.php?title=QALY&oldid=149362956){target="_blank"}).

::: {.callout-caution title="Precaucion"}
Evitar el uso de ABM para la inferencia causal y prediccion es mera opinion del autor. Existe una amplia literatura donde se utilizan los ABMs para estos fines.
:::



# Aplicación: Escuelas en Utah {background-color="#be0000"}

## Modelo Implementado {style="font-size: 80%"}

El siguiente diagrama ilustra una version simplificada del modelo de transmisión dentro de las escuelas en Utah. Este modelo fue desarrollado en conjunto con el Departamento de Salud y Servicios Humanos de Utah. Una version interactive del modelo esta en <https://ggv.cl/shiny/measles>:

```{mermaid}
flowchart TB
    Susceptible -->|Starts quarantine| QuarantineS["Quarantine<br>Susceptible"]
    QuarantineS -->|Ends quarantine| Susceptible
    Susceptible --> Exposed

    Exposed     -->|Starts quarantine| Quarantine["Quarantine<br>or Isolated"]
    Quarantine  -->|Ends quarantine| Exposed
    Exposed     -->|Disease progression| Prodromal
    
    Prodromal   -->|Starts quarantine| Quarantine
    Quarantine  -->|Ends quarantine| Prodromal
    Prodromal   -->|Disease progression| Rash
    
    Rash        --> |Starts quarantine| Quarantine
    Quarantine  --> |Ends quarantine| Rash
    Rash        --> |Disease progression| Hospitalized
    Rash        --> |Disease progression| Recovered
    
    Quarantine  --> |Disease progression| Hospitalized
    Hospitalized--> |Disease progression| Recovered
    Hospitalized--> |Starts quarantine| Quarantine
    Quarantine  --> |Ends quarantine| Recovered
```

## Fin {style="font-size: 150%"}

::: {style="text-align: center;"}
Gracias! 

**Transmision y Contagio en Redes**<br>*Una introduccion breve*
:::


## Bibliografía

::: {#refs}
:::

# Apéndice {.appendix background-color="black"}

## Uso de la IA

El desarrollo de esta presentación fue asistido por inteligencia artificial (IA) utilizando GitHub Copilot. En su totalidad, la IA ayudó a simplificar el proceso, pero no reemplazó la generación de contenido original.
## Aplicación: Escuelas en Utah

